#!/usr/bin/python3

from bs4 import BeautifulSoup
import re,sys,requests


def cvelistlines(cvelists):
	cve_lists = []
	for line in cvelists:
		url = "https://nvd.nist.gov/vuln/detail/" + line
		response = requests.get(url)

		soup = BeautifulSoup(response.content, "html.parser")
		VDP = soup.find(id="vulnDetailPanel")
		
		if VDP is not None:
			date = VDP.find("span", attrs={"data-testid": "vuln-published-on"}).text
			cve_info = line + ","+ date
		else:
			cve_info = line + ","+ "N/A"

		cve_lists.append(cve_info)
	return cve_lists

input_file = sys.argv[1]
output_file = sys.argv[2]


print ("[+]	CVE Published Date are being extracted from NVD NIST")
print ("[+]	Please wait until it is finished...")

lines = open(input_file, 'r').readlines()
lines = [line.strip() for line in lines]
cve_info_list = cvelistlines(lines)

open_output = open(output_file, 'w')

for cve in cve_info_list:
	open_output.write(cve)
	open_output.write('\n')

print ("[+]	Done!")
